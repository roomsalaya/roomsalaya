import{r as c,j as e,M as N,B as q,C as f,D as l,A as S,E as x,F as b,G as A,I as k}from"./index-1ydYyeaN.js";const F=()=>{const[g,v]=c.useState([]),[n,d]=c.useState({month:"",name:"",room:"",rent:"",electricity:"",water:"",total:"",status:!1}),[i,h]=c.useState(null),[C,u]=c.useState(!1),o=async()=>{try{const t=await q(f(l,"invoices202")),s=[];t.forEach(a=>{s.push({id:a.id,...a.data()})}),s.sort((a,m)=>{var p,y;return(((p=a.createdAt)==null?void 0:p.seconds)||0)-(((y=m.createdAt)==null?void 0:y.seconds)||0)}),v(s)}catch(t){console.error("Error fetching invoices: ",t)}};c.useEffect(()=>{o()},[]);const r=t=>{const{name:s,value:a}=t.target;d({...n,[s]:a})},w=async t=>{t.preventDefault();try{const s=S.currentUser;if(!s){console.error("No authenticated user");return}const a={...n,email:s.email,createdAt:new Date};if(i){const m=x(l,"invoices202",i);await b(m,a),await o(),h(null)}else await A(f(l,"invoices202"),a),await o();d({month:"",name:"",room:"",rent:"",electricity:"",water:"",total:"",status:!1}),u(!1)}catch(s){console.error("Error adding/updating document: ",s)}},E=t=>{d(t),h(t.id||null),u(!0)},j=()=>{h(null),d({month:"",name:"",room:"",rent:"",electricity:"",water:"",total:"",status:!1}),u(!1)},I=async t=>{try{const s=x(l,"invoices202",t.id);await b(s,{status:!t.status}),o()}catch(s){console.error("Error updating status: ",s)}},D=async t=>{try{await k(x(l,"invoices202",t)),o()}catch(s){console.error("Error deleting document: ",s)}};return e.jsxs("div",{className:"house-info-container",children:[e.jsx("h2",{children:"รายการแจ้งหนี้ห้อง 202"}),e.jsx("button",{className:"add-invoice-button",onClick:()=>u(!0),children:"Add Invoice"}),e.jsxs(N,{isOpen:C,onRequestClose:j,contentLabel:"Invoice Form",className:"invoice-modal",overlayClassName:"invoice-modal-overlay",children:[e.jsx("h2",{children:i?"Edit Invoice":"Add Invoice"}),e.jsxs("form",{onSubmit:w,className:"invoice-form",children:[e.jsx("input",{type:"text",name:"month",value:n.month,onChange:r,placeholder:"เดือน",required:!0}),e.jsx("input",{type:"text",name:"name",value:n.name,onChange:r,placeholder:"ชื่อ",required:!0}),e.jsx("input",{type:"text",name:"room",value:n.room,onChange:r,placeholder:"ห้อง",required:!0}),e.jsx("input",{type:"number",name:"rent",value:n.rent,onChange:r,placeholder:"ค่าเช่า",required:!0}),e.jsx("input",{type:"number",name:"electricity",value:n.electricity,onChange:r,placeholder:"ค่าไฟ",required:!0}),e.jsx("input",{type:"number",name:"water",value:n.water,onChange:r,placeholder:"ค่าน้ำ",required:!0}),e.jsx("input",{type:"number",name:"total",value:n.total,onChange:r,placeholder:"รวม",required:!0}),e.jsx("button",{type:"submit",children:i?"Save Changes":"Add Invoice"}),e.jsx("button",{type:"button",onClick:j,children:"Cancel"})]})]}),e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"เดือน"}),e.jsx("th",{children:"ชื่อ"}),e.jsx("th",{children:"ห้อง"}),e.jsx("th",{children:"ค่าเช่า"}),e.jsx("th",{children:"ค่าไฟ"}),e.jsx("th",{children:"ค่าน้ำ"}),e.jsx("th",{children:"รวม"}),e.jsx("th",{children:"สถานะ"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:g.map(t=>e.jsxs("tr",{children:[e.jsx("td",{children:t.month}),e.jsx("td",{children:t.name}),e.jsx("td",{children:t.room}),e.jsx("td",{children:t.rent}),e.jsx("td",{children:t.electricity}),e.jsx("td",{children:t.water}),e.jsx("td",{children:t.total}),e.jsx("td",{className:t.status?"paid-status":"unpaid-status",children:t.status?"อนุมัติชำระ":"รออนุมัติชำระ"}),e.jsxs("td",{children:[e.jsx("button",{className:"edit-button",onClick:()=>E(t),children:"Edit"}),e.jsx("button",{className:`toggle-status-button ${t.status?"paid-status":"unpaid-status"}`,onClick:()=>I(t),children:t.status?"อนุมัติชำระ":"รออนุมัติชำระ"}),e.jsx("button",{className:"delete-button",onClick:()=>D(t.id),children:"Delete"})]})]},t.id))})]})]})};export{F as default};
